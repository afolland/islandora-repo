uuid: 10e5f360-aa8d-4c2b-b7b5-4d0d5c738aff
langcode: en
status: true
dependencies:
  enforced:
    module:
      - asu_migrate
id: acc_2016_05046_media
class: null
field_plugin_method: null
cck_plugin_method: null
migration_tags:
  - acc_2016_05046
  - media
migration_group: acc_2016_05046
label: 'acc_2016_05046 Media'
source:
  plugin: csv
  path: /mnt/libfile/Repository/migrations/prism/metadata/ACC_2016_05046.tsv
  delimiter: "\t"
  header_row_count: 1
  ids:
    - ID
  constants:
    use: 'Service File'
    uid: 1
process:
  bundle:
    -
      plugin: skip_on_empty
      source: 'File Location'
      method: row
    -
      plugin: callback
      callable: pathinfo
    -
      plugin: extract
      index:
        - extension
    -
      plugin: static_map
      default_value: file
      map:
        jpg: image
        jpeg: image
        mp4: video
  name:
    source: Title
    plugin: substr
    start: 0
    length: 254
  uid:
    plugin: user_lookup
    source: 'System Creator - ASURITE'
    default_value: constants/uid
  field_original_name:
    -
      plugin: callback
      callable: basename
      source: 'File Location'
    -
      plugin: skip_on_empty
      method: row
      message: 'Cannot import empty filename.'
  field_media_use:
    -
      plugin: entity_lookup
      source: constants/use
      entity_type: taxonomy_term
      value_key: name
      bundle_key: vid
      bundle: islandora_media_use
  field_media_video_file:
    -
      plugin: skip_on_empty
      method: process
      source: ID
    -
      plugin: migration_lookup
      migration: acc_2016_05046_file
      no_stub: true
  field_media_of:
    -
      plugin: migration_lookup
      source: ID
      migration: acc_2016_05046_node
      no_stub: true
  field_access_terms:
    -
      plugin: get
      source: 'Derivative File Permissions'
    -
      plugin: default_value
      default_value: Private
    -
      plugin: entity_lookup
      bundle: islandora_access
      bundle_key: vid
      entity_type: taxonomy_term
      value_key: name
  field_mime_type:
    -
      plugin: skip_on_empty
      source: 'File Location'
      method: row
      message: 'Cannot import an empty filename column.'
    -
      plugin: callback
      callable: pathinfo
    -
      plugin: extract
      index:
        - extension
    -
      plugin: static_map
      default_value: application/octet-stream
      map:
        jpg: image/jpeg
        jpeg: image/jpeg
        tif: image/tiff
        tiff: image/tiff
        jpf: image/jp2
        jp2: image/jp2
        mp4: video/mp4
        mov: video/quicktime
destination:
  plugin: 'entity:media'
migration_dependencies:
  required:
    - migrate_plus.migration.acc_2016_05046_file
    - migrate_plus.migration.acc_2016_05046_node
  optional: {  }
